<html class="no-js" lang="en-GB">
  <head>
    <meta charset="utf-8" />
    <title>Passengers dropdown test</title>
    <script>
      document.documentElement.className =
        document.documentElement.className.replace(/\bno-js\b/, "js");
    </script>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <link rel="stylesheet" href="global.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script defer src="./scripts/input-number.js"></script>
    <script defer src="./scripts/passengers.js"></script>
    <link rel="stylesheet" href="./styles/passengers.css" />
    <style>
      form {
        align-items: start;
      }

      .input--passengers {
        text-align: start;
      }

      .no-js [hidden] {
        display: block !important;
      }
    </style>
  </head>
  <body>
    <header>
      <a href="./"><abbr title="accessibility">a11y</abbr> tests</a>
    </header>
    <main id="main">
      <h1>Passengers dropdown test</h1>
      <details>
        <summary>Description</summary>
        <p>
          The user needs to be able to select the number and type of passengers
          for their booking.
        </p>
        <p>
          We want a solution that allows users who use a mouse (or pointer),
          their keyboard, and/or a screen-reader to be able to easily select
          passenger combinations from the list.
        </p>
      </details>
      <details>
        <summary>Success criteria</summary>
        <ul>
          <li>
            The user can click into the passengers <code>button</code> and be
            shown a list of options, they can click the relevant plus and minus
            buttons to increase or decrease the quantities for the relevant
            passenger types.
          </li>
          <li>
            After the user presses OK the passengers button should be updated
            with a summary of the selected choices.
            <em>Note: this behaviour is not shown here</em>.
          </li>
          <li>
            The keyboard user can use their keyboard to show and hide the
            passenger options menu.
          </li>
          <li>
            The keyboard user can visually see when the toggle buttons, the plus
            and minus buttons, and the number <code>input</code>s are active/in
            focus.
          </li>
          <li>
            The keyboard user should be able to tab to any elements inside
            either the wheelchair or the default passengers dropdown until they
            become visible on screen.
          </li>
          <li>
            The user can use a combination of their mouse and their keyboard to
            navigate and select passenger quantity values.
          </li>
          <li>
            The screen-reader user is informed what inputs/labels that the plus
            and minus buttons are controlling when they come into focus.
          </li>
          <li>
            The screen-reader user is informed that the options have changed
            when they toggle to/from wheelchair user.
          </li>
          <li>
            The screen-reader user is not informed about any Thalys pass or
            wheelchair icons in the user interface.
          </li>
          <li>
            The screen-reader user is informed when errors occurred are
            dynamically displayed.
          </li>
          <li>
            The screen-reader user is informed when form field hints like those
            for the child options are dynamically displayed and/or if they are
            displayed from the beginning.
          </li>
          <li>
            The screen-reader user should be informed of their selected options
            after they press the OK button and when the passengers
            <code>button</code> regains focus.
            <em>Note: this behaviour is not shown here</em>.
          </li>
          <li>
            The screen-reader user should be informed of any elements inside
            either the wheelchair or the default passengers dropdown until they
            become visible on screen.
          </li>
        </ul>
      </details>
      <details>
        <summary>Keyboard navigation</summary>
        <p>
          The user should be <kbd>Tab</kbd> into the button, press
          <kbd>Down Arrow</kbd> to display the options then use
          <kbd>Tab</kbd> to navigate through the list options. If the user
          presses <kbd>Enter or Space</kbd> button while they are on an plus or
          minus button then relevant input should be increased/decreased.
        </p>
        <p>
          After the user tabs past the last item, the passengers dropdown should
          be hidden.
          <em>Note: this behaviour is not shown here</em>.
        </p>
        <p>
          If the user presses <kbd>Escape</kbd> while the passengers dropdown is
          open it should be closed.
        </p>
      </details>
      <form action="" method="get">
        <div class="field">
          <input
            aria-label="To"
            class="input"
            name="to"
            placeholder="To"
            type="text"
          />
        </div>
        <div class="field">
          <input
            aria-label="From"
            class="input"
            name="from"
            placeholder="From"
            type="text"
          />
        </div>
        <div class="field">
          <input
            aria-label="Date"
            class="input"
            placeholder="Date"
            type="date"
          />
        </div>
        <div class="field field--passengers">
          <button
            aria-controls="passengers-dropdown"
            aria-expanded="false"
            aria-live="polite"
            class="input input--passengers"
            id="passengers-button"
            type="button"
          >
            Passengers
          </button>
          <!--
            The 'dropdown' contains the passengers options:
            The `hidden` attribute is like `display:none` so it makes it hidden from search engines but
            if you want to animate this component in, you'll need `aria-hidden="true"` alongside your CSS
            instead of `hidden` but you may have to add `inert` too to ensure inputs, buttons, and links
            inside the dropdown cannot receive focus.

            TODO Inform the user when they are no longer in wheelchair user mode
          -->
          <div class="passengers-dropdown" hidden id="passengers-dropdown">
            <ul>
              <li class="field">
                <label for="passengers-input-adult" id="passengers-label-adult">
                  Adult
                  <span>(26+ years)</span>
                </label>
                <div data-js-number>
                  <button
                    aria-describedby="passengers-label-adult error-adult-1 error-adult-2"
                    aria-label="Decrease Adult passenger number by 1"
                    data-js-decrease
                    type="button"
                  >
                    -
                  </button>
                  <!--
                    For number inputs we use inputmode to get the number keypad on virtual keyboards
                    and avoid the weird UX of input type="number"
                  -->
                  <input
                    aria-describedby="error-adult-1 error-adult-2"
                    id="passengers-input-adult"
                    inputmode="numeric"
                    name="adult"
                    type="text"
                    value="0"
                  />
                  <button
                    aria-describedby="passengers-label-adult error-adult-1 error-adult-2"
                    aria-label="Increase Adult passenger number by 1"
                    data-js-increase
                    type="button"
                  >
                    +
                  </button>
                </div>
                <div class="error" id="error-adult-1">
                  There must be at least one adult, youth or senior per booking.
                </div>
                <div class="error" id="error-adult-2">
                  To book for 10 or more people, please use our group booking
                  form.
                </div>
              </li>
              <li class="field">
                <label for="passengers-input-youth" id="passengers-label-youth">
                  Youth <span>(12-25 years)</span>
                </label>
                <div>
                  <button
                    aria-describedby="passengers-label-youth"
                    aria-label="Decrease Youth passenger number by 1"
                    data-js-decrease
                    type="button"
                  >
                    -
                  </button>
                  <input
                    id="passengers-input-youth"
                    inputmode="numeric"
                    name="youth"
                    type="text"
                    value="0"
                  />
                  <button
                    aria-describedby="passengers-label-youth"
                    aria-label="Increase Youth passenger number by 1"
                    data-js-increase
                    type="button"
                  >
                    +
                  </button>
                </div>
              </li>
              <li class="field">
                <label for="passengers-input-child" id="passengers-label-child">
                  Child <span>(0-11 years)</span>
                </label>
                <div>
                  <button
                    aria-describedby="passengers-label-child"
                    aria-label="Decrease child passenger number by 1"
                    data-js-decrease
                    type="button"
                  >
                    -
                  </button>
                  <input
                    id="passengers-input-child"
                    inputmode="numeric"
                    name="child"
                    type="text"
                    value="0"
                  />
                  <button
                    aria-describedby="passengers-label-child"
                    aria-label="Increase child passenger number by 1"
                    data-js-increase
                    type="button"
                  >
                    +
                  </button>
                </div>

                <small id="passengers-hint-child">
                  Children receive up to 30% off our standard fares. Please
                  check the price summary when choosing your ticket.
                </small>
              </li>
              <li class="field">
                <label
                  aria-describedby="passengers-hint-infant"
                  for="passengers-input-infant"
                  id="passengers-label-infant"
                >
                  Infant
                  <span>(0-3 years) (free on lap)</span>
                </label>
                <div>
                  <button
                    aria-describedby="passengers-label-infant passengers-hint-infant"
                    aria-label="Decrease infant passenger number by 1"
                    data-js-decrease
                    type="button"
                  >
                    -
                  </button>
                  <input
                    aria-describedby="passengers-hint-infant"
                    id="passengers-input-infant"
                    inputmode="numeric"
                    name="infant"
                    type="text"
                    value="0"
                  />
                  <button
                    aria-describedby="passengers-label-infant passengers-hint-infant"
                    aria-label="Increase infant passenger number by 1"
                    data-js-increase
                    type="button"
                  >
                    +
                  </button>
                </div>
                <small id="passengers-hint-infant">
                  Infants can travel for free on an adult's lap and just need a
                  passport. You can only take one infant per adult.
                </small>
              </li>
              <li class="field">
                <label for="thalys">Thalys pass</label>
                <input
                  class="toggle"
                  id="thalys"
                  name="thalys"
                  type="checkbox"
                  value="true"
                />
              </li>
              <li class="field">
                <label for="wheelchair">Wheelchair user</label>
                <input
                  class="toggle wheelchair-button"
                  id="wheelchair"
                  name="wheelchair"
                  type="checkbox"
                  value="true"
                />
              </li>
            </ul>
            <div class="field field--buttons">
              <button class="button button--full-width" type="button">
                Ok
              </button>
            </div>
          </div>
          <!--
            This 'dropdown' contains the wheelchair + their companion passenger options:
            The `hidden` attribute is like `display:none` so it makes it hidden from search engines but
            if you want to animate this component in, you'll need `aria-hidden="true"` alongside your CSS
            instead of `hidden` but you may have to add `inert` too to ensure inputs, buttons, and links
            inside the dropdown cannot receive focus


            TODO Inform the user that they are looking at a wheelchair user mode
          -->
          <div
            class="passengers-dropdown"
            hidden
            id="passengers-wheelchair-dropdown"
          >
            <ul>
              <li class="field">
                <label
                  for="passengers-id-adult-wheelchair"
                  id="passengers-label-adult-wheelchair"
                >
                  Adult (26+ years)
                  <span>in wheelchair</span>
                </label>
                <div data-js-number>
                  <button
                    aria-describedby="passengers-label-adult-wheelchair"
                    aria-label="Decrease number by 1"
                    data-js-decrease
                    type="button"
                  >
                    -
                  </button>
                  <input
                    id="passengers-id-adult-wheelchair"
                    inputmode="numeric"
                    name="adult"
                    type="text"
                    value="0"
                  />
                  <button
                    aria-describedby="passengers-label-adult-wheelchair"
                    aria-label="Increase number by 1"
                    data-js-increase
                    type="button"
                  >
                    +
                  </button>
                </div>
              </li>
              <li class="field">
                <label
                  for="passengers-id-youth-wheelchair"
                  id="passengers-label-youth-wheelchair"
                >
                  Youth (12-25 years)
                  <span>in wheelchair</span>
                </label>
                <div>
                  <button
                    aria-describedby="passengers-label-youth-wheelchair"
                    aria-label="Decrease number by 1"
                    data-js-decrease
                    type="button"
                  >
                    -
                  </button>
                  <input
                    id="passengers-id-youth-wheelchair"
                    inputmode="numeric"
                    name="youth"
                    type="text"
                    value="0"
                  />
                  <button
                    aria-describedby="passengers-label-youth-wheelchair"
                    aria-label="Increase number by 1"
                    data-js-increase
                    type="button"
                  >
                    +
                  </button>
                </div>
              </li>
              <li class="field">
                <label
                  for="passengers-input-child-wheelchair"
                  id="passengers-label-child-wheelchair"
                >
                  Child (0-11 years)
                  <span>in wheelchair</span>
                </label>
                <div>
                  <button
                    aria-describedby="passengers-label-child-wheelchair"
                    aria-label="Decrease number by 1"
                    data-js-decrease
                    type="button"
                  >
                    -
                  </button>
                  <input
                    id="passengers-input-child-wheelchair"
                    inputmode="numeric"
                    name="child"
                    type="text"
                    value="0"
                  />
                  <button
                    aria-describedby="passengers-label-child-wheelchair"
                    aria-label="Increase number by 1"
                    data-js-increase
                    type="button"
                  >
                    +
                  </button>
                </div>
                <small id="passengers-hint-child-companion">
                  Children must travel with a companion that is 16 years or
                  older.
                </small>
              </li>
              <li class="field">
                <label
                  for="passengers-input-companion"
                  id="passengers-label-companion"
                >
                  Companion
                  <span>(concession fare)</span>
                </label>
                <div>
                  <button
                    aria-describedby="passengers-label-companion"
                    aria-label="Decrease number by 1"
                    data-js-decrease
                    type="button"
                  >
                    -
                  </button>
                  <input
                    id="passengers-input-companion"
                    inputmode="numeric"
                    name="companion"
                    type="text"
                    value="0"
                  />
                  <button
                    aria-describedby="passengers-label-companion"
                    aria-label="Increase number by 1"
                    data-js-increase
                    type="button"
                  >
                    +
                  </button>
                </div>
              </li>
              <li class="field">
                <label for="wheelchair2">Wheelchair user</label>
                <input
                  aria-describedby="passengers-hint-wheelchair2"
                  checked
                  class="toggle wheelchair-button"
                  id="wheelchair2"
                  name="wheelchair"
                  type="checkbox"
                  value="true"
                />
                <small id="passengers-hint-wheelchair2">
                  Each wheelchair user can take one companion.
                </small>
              </li>
            </ul>
            <div class="field">
              <button class="button button--full-width" type="button">
                Ok
              </button>
            </div>
          </div>
          <!--
            The following live region will inform screen readers
            what the user has selected as they add passenger options via the form
          -->
          <div aria-live="polite" class="sr-only" id="passengers-live-region">
            Currently selected: 0 passengers.
          </div>
        </div>
        <div class="field field--buttons">
          <button type="submit">Search</button>
        </div>
      </form>
    </main>
  </body>
</html>
